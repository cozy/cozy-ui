@require '../settings/palette'
@require '../settings/icons'
@require '../utilities/display'
@require '../utilities/text'
@require '../tools/mixins'

/*------------------------------------*\
  Variants
\*------------------------------------*/
regularTheme = {
    primaryColor: dodgerBlue, secondaryColor: dodgerBlue, activeColor: scienceBlue, contrastColor: white
}

highlightTheme = {
    primaryColor: emerald, secondaryColor: emerald, activeColor: malachite, contrastColor: white
}
dangerTheme = {
    primaryColor: pomegranate, secondaryColor: pomegranate, activeColor: monza, contrastColor: white
}
alphaTheme = {
    primaryColor: transparent, secondaryColor: white, activeColor: scienceBlue, contrastColor: white
}
secondaryTheme = {
    primaryColor: white, secondaryColor: silver, activeColor: silver, contrastColor: black
}
dangerOutlineTheme = {
    primaryColor: white, secondaryColor: yourPink, activeColor: yourPink, contrastColor: pomegranate
}

// We turn stylint off since without semicolons, stylus fails to
// parse the following code block.
// @stylint off
themedBtn(theme)
    background-color: theme['primaryColor']
    color: theme['contrastColor']
    border-color: theme['secondaryColor']

    &:visited
        color: theme['contrastColor']

    &:active
    &:hover
    &:focus
        border-color:      theme['activeColor']
        background-color:  theme['activeColor']

    &[disabled]
    &[aria-disabled=true]
        &:hover
            background-color: theme['primaryColor']

/*------------------------------------*\
  Button
\*------------------------------------*/

$button
    box-sizing       border-box
    display          inline-flex
    margin           0 .25em
    border-width     1px
    border-style     solid
    border-radius    2px
    min-height       2.5rem
    min-width        7rem
    padding          .2rem 1rem
    vertical-align   top
    text-align       center
    font-size        .875rem
    line-height      1
    text-transform   uppercase
    text-decoration  none
    cursor           pointer

    svg
        fill         currentColor
        margin-right .4rem

        &:only-child
            margin 0

    input
        cursor pointer

    > span
        display          flex
        align-items      center
        justify-content  center
        width            100%

    &[disabled]
    &[aria-disabled=true]
        opacity  .5
        cursor   not-allowed

        input
            cursor not-allowed

    &[aria-busy=true]
        > span::after
            @extend    $icon-16
            @extend    $icon-spinner-white
            position   relative
            top        -.0625rem

    themedBtn(regularTheme)

$button--regular  // Deprecated
    @extend $button

$button--highlight
    themedBtn(highlightTheme)

$button--alpha
    themedBtn(alphaTheme)

$button--danger
    themedBtn(dangerTheme)

$button--secondary
    themedBtn(secondaryTheme)

$button--danger-outline
    themedBtn(dangerOutlineTheme)

// @stylint on

/* specific case for spinner */
$button--danger-outline
    &[aria-busy=true]
        > span::after
            @extend  $icon-spinner-red

$button--secondary
    &[aria-busy=true]
        > span::after
            @extend  $icon-spinner-blue
/* end specific case for spinner */

$link--upload
    background-image     embedurl('../assets/icons/ui/icon-upload-grey08.svg')
    background-position  1rem center
    background-repeat    no-repeat

$link--delete
    background-image     embedurl('../assets/icons/ui/icon-delete-grey08.svg')
    background-position  1rem center
    background-repeat    no-repeat

$button--action
    @extend $button--alpha
    border-color transparent
    padding .5rem
    opacity     .5

    svg
        margin 0

    &:active
    &:hover
    &:focus
        background-color  transparent
        border-color transparent

$button--close
    @extend $button--alpha
    border-color transparent
    padding .5rem

    svg
        margin 0

    &:active
    &:hover
    &:focus
        background-color  transparent
        border-color transparent

$button-alert
    border       0
    height       auto
    padding      .5rem 1rem
    background-color white
    font-weight  bold
    font-size .9rem

$button-alert--error
    @extend $button-alert
    color   pomegranate

    &:visited
        color pomegranate

    &:active
    &:hover
    &:focus
        color  darken(pomegranate, 25%)

$button-alert--info
    @extend           $button-alert
    background-color  coolGrey
    color             white

    &[disabled]
    &[aria-disabled=true]
        &:hover
            background-color coolGrey

    &:visited
        color white

    &:active
    &:hover
    &:hover
    &:focus
        color  darken(white, 10%)
        background-color  darken(coolGrey, 10%)

$button-alert--success
    @extend $button-alert
    color   emerald

    &:visited
        color emerald

    &:active
    &:hover
    &:focus
        color darken(emerald, 25%)

$button-client
    @extend $button
    @extend $button--secondary
    display           flex
    justify-content   center
    align-items       center
    height            auto
    margin            0
    padding-left      1rem
    padding-right     1rem
    background-color  transparent
    text-align        left
    font-size         .8125rem
    font-weight       bold
    line-height       1.3
    color             slateGrey

    &:visited
        color slateGrey

    &:before
        content           ''
        flex              0 0 2rem
        height            2rem
        margin-right      .75rem
        background        embedurl('../assets/icons/ui/icon-device-laptop.svg') 0 0 / contain no-repeat

    span
        flex  0 1 auto

$button-client-mobile
    @extend $button-client
    display          flex
    justify-content  flex-start
    background-color dodgerBlue
    border           0
    border-radius    0
    padding          .5em 3em .5em 1em
    font-size        1rem
    font-weight      normal
    color            white
    text-decoration  none
    text-transform   none

    &[disabled]
    &[aria-disabled=true]
        &:hover
            background-color dodgerBlue

    &:visited
        color white

    &:active
    &:hover
    &:focus
        background-color dodgerBlue

    &:before
        flex                0 0 2.75rem
        height              2.75rem
        border-radius       .5em
        border              .3em solid white
        background          white embedurl('../assets/icons/ui/icon-cozy.svg') 0 0 / contain no-repeat

/*------------------------------------*\
  Sizes
\*------------------------------------*/
$button--tiny
    min-height 1.5rem
    min-width 5rem
    padding .15rem 1rem

$button--small
    min-height 2rem
    min-width 6rem
    padding .2rem .5rem

$button--large
    min-height 3rem
    min-width 10rem
    padding .5rem 1.5rem
    font-size 1rem

/*------------------------------------*\
  Extensions
\*------------------------------------*/
$button--full
    width 100%
    margin 0

$button--narrow
    min-width auto

/*------------------------------------*\
  Action button
\*------------------------------------*/
$actionbtn
    @extend $button
    border-color silver
    text-transform none
    max-width 12.5rem
    min-height 2rem
    width 100%
    padding-right .5rem
    text-align left
    line-height 1.3

    > span
        justify-content flex-start
        flex-wrap nowrap

    [data-action='icon']
        border-left .0625rem solid silver

    &:not([disabled]):hover
    &:not([disabled]):focus
        [data-action='icon']
            border-color currentColor

$actionbtn--compact
    @extend $button--narrow
    position relative
    border 0
    background-color transparent
    padding 0
    margin 0
    min-height 2rem
    width 2.5rem

    > span
        justify-content center

    svg
        margin 0

    [data-action='label']
        @extend $hide

    [data-action='icon']
        border-left none
        margin-left 0
        padding 0

    &:hover
    &:focus
        background-color paleGrey
        border 0

actionbtnVariant(bgColor, txtColor, bdColor)
    background-color bgColor
    color txtColor
    border-color bdColor

    [data-action='icon']
        border-color bdColor

    &:hover
    &:focus
        background-color bdColor
        border-color txtColor

    &[disabled]:hover
    &[aria-disabled=true]:hover
        background-color bgColor

$actionbtn--normal
    actionbtnVariant(paleGrey, charcoalGrey, silver)

$actionbtn--error
    actionbtnVariant(chablis, pomegranate, yourPink)

$actionbtn--new
    actionbtnVariant(zircon, dodgerBlue, frenchPass)
    border-width .0625rem
    border-style dashed

    &:hover:not([disabled])
    &:focus:not([disabled])
        border-style solid

$actionbtn-label
    @extend $ellipsis
    padding-right .5rem

$actionbtn-icon
    display block
    margin-left auto
    padding-left .5rem

    svg
        display block

/*------------------------------------*\
  Variants
\*------------------------------------*/
// We turn stylint off since without semicolons, stylus fails to
// parse the following code block.
// @stylint off
themedBtnSubtle(theme)
    color: theme['secondaryColor']

    &:active
    &:focus
    &:hover
        color: theme['activeColor']

sizedBtnSubtle(size)
    sizes = {
        tiny: .6rem, small: .75rem, large: 1rem
    }

    min-height 0
    min-width 0
    padding 0
    font-size sizes[size]

$button-subtle
    themedBtnSubtle(regularTheme)
    min-height auto
    min-width auto
    border 0
    margin 1rem 0
    padding 0
    vertical-align baseline
    background transparent
    cursor pointer
    font-size .875rem
    font-weight bold
    text-transform uppercase

    svg
        fill         currentColor
        margin-right .4rem

        &:only-child
            margin 0

    > span
        display          flex
        align-items      center
        justify-content  center
        width            100%

    &[disabled]
    &[aria-disabled=true]
        opacity  .5
        cursor   not-allowed

        &:hover
            background transparent

    &:active
    &:hover
    &:focus
        color scienceBlue
        background transparent

    &[aria-busy=true] > span::after
        @extend $icon-16
        @extend $icon-spinner-blue
        position relative
        top -.0625rem

    * + &
        margin-left 1em

$button-subtle--tiny
    sizedBtnSubtle('tiny')

$button-subtle--small
    sizedBtnSubtle('small')

$button-subtle--large
    sizedBtnSubtle('large')

$button-subtle--danger
    themedBtnSubtle(dangerTheme)

    &[aria-busy=true] > span::after
        @extend $icon-spinner-red

$button-subtle--highlight
    themedBtnSubtle(highlightTheme)

    &[aria-busy=true] > span::after
        @extend $icon-spinner-grey

$button-subtle--regular
    themedBtnSubtle(regularTheme)

$button-subtle--secondary
    themedBtnSubtle(secondaryTheme)

    &[aria-busy=true] > span::after
        @extend $icon-spinner-grey

    &:active
    &:focus
    &:hover
        color coolGrey
// @stylint on
